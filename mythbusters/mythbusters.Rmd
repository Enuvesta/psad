---
title: "Разрушители легенд: тыльная сторона руки"
output: html_document
---
## Часть 1
В 5 серии 13 сезона передачи "Разрушители легенд" проверялась справедливость выражения "know something like the back of one's hand". 
В эксперименте принимало участие 12 испытуемых. Каждому из них были предъявлены 10 фотографий похожих рук разных людей, среди которых они должны были угадать свою.

11 из 12 испытуемых выбрали свою фотографию.

$H_0$: испытуемые выбирают фотографии тыльной стороны руки наугад ($p=0.1$).

$H_1$: испытуемые выбирают фотографию тыльной стороны своей собственной руки осознанно ($p>0.1$).

Точный биномиальный критерий:
```{r}
binom.test(11, 12, p=0.1, alternative = "greater")
```

Критерий отношения правдоподобия:
```{r}
prop.test(11, 12, p=0.1, correct=FALSE, alternative = "greater") 
```
заодно возвращает доверительный интервал, основанный на инверсии этого критерия.

А вот так можно получить доверительный интервал Уилсона:
```{r}
library("PropCIs")
scoreci(11, 12, 0.95)

library(Hmisc, quietly = TRUE, warn.conflicts=FALSE) 
binconf(x=11, n=12, alpha=.05, method="wilson")
```

Для сравнения посчитаем достигаемые уровни значимости критериев Вальда и множителей Лагранжа:
```{r}
n  <- 12
y  <- 11
p  <- y/n
p0 <- 0.1

zw  <- (p-p0) / sqrt(  p * (1-p)  / n )
pnorm(zw, lower.tail=FALSE)
zlm <- (p-p0) / sqrt( p0 * (1-p0) / n )
pnorm(zlm, lower.tail=FALSE)
```

## Часть 2

Аналогичный эксперимент был проведён с фотографиями ладоней. 7 из 12 испытуемых угадали свою фотографию. 

$H_0$: испытуемые выбирают фотографии ладони наугад ($p=0.1$).

$H_1$: испытуемые выбирают фотографию своей собственной ладони осознанно ($p>0.1$).
```{r}
binom.test(7, 12, p=0.1, alternative = "greater")
```

Можно ли утверждать, что тыльную сторону руки люди знают лучше, чем ладонь?
Сравним результаты экспериментов.  
Поскольку это одни и те же испытуемые, выборки связные, но информации о связности нет, поэтому мы вынуждены использовать критерии для независимых выборок. 
Z-критерий:
```{r}
y1 <- 11
y2 <- 7
n  <- 12

P <- (y1+y2) / (2*n)
zw <- (y1/n - y2/n) / sqrt(P*(1-P)*(2/n))
pnorm(-abs(zw)) * 2
```
95% доверительный интервал Уилсона:
```{r}
diffscoreci(11, 12, 7, 12, 0.95)
```
Его инверсия:
```{r}
source("invertCI.R")
CIfun <- function(CL) diffscoreci(11, 12, 7, 12, CL)$conf.int
invertCI(CIfun, precision=8, theta0=0)
```

![alt text](http://www.quickmeme.com/img/2b/2bb8924e36c0258875e3756c3695de1f17b5eaa124b5ccd24cb778c8cc511364.jpg)
